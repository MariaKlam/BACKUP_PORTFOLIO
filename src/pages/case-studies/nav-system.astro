---
import Base from "../../layouts/Base.astro";
import "../../styles/nav.css";


---

<Base title="Case Study: Unified Navigation (Private)"
      bodyClass="menu--sidebar"                 /* or menu--topnav */
      noWrap={true}                             /* we’ll place things ourselves */
      hideFooter={true}>
<script type="module">
  import { initNavLite } from '/src/scripts/nav-page.ts';   // ← absolute path
  // run on first load
  initNavLite();
  // also run when Astro swaps pages client-side
  addEventListener('astro:page-load', initNavLite);
</script>

<script type="module">
(() => {
  const KEY = 'demo:favorites';
  const DEMO_APP = { id: 'reports', label: 'Reports', icon: 'ri-file-text-line' };
  const favList  = document.getElementById('favApps');
  const starBtns = [...document.querySelectorAll('.favorite-toggle-button')];

  const getFavs = () => {
    try { return JSON.parse(localStorage.getItem(KEY) || '[]'); }
    catch { return []; }
  };
  const setFavs = (arr) => localStorage.setItem(KEY, JSON.stringify(arr));

  const render = () => {
    const favs = getFavs();
    const isFav = favs.includes(DEMO_APP.id);

    // Update all star buttons (in header, duplicated, etc.)
    starBtns.forEach(btn => {
      btn.classList.toggle('is-favorite', isFav);
      btn.setAttribute('aria-pressed', String(isFav));
      btn.title = isFav ? 'Remove from favorites' : 'Add to favorites';
      // swap icons (use whatever your filled name is)
      btn.innerHTML = isFav ? '<i class="ri-star-fill"></i>' : '<i class="ri-star-line"></i>';
    });

    // Rebuild favorites list
    if (!favList) return;
    favList.innerHTML = '';
    favs.forEach(id => {
      const app = id === DEMO_APP.id ? DEMO_APP : null;
      if (!app) return;
      const li = document.createElement('li');
      li.className = 'thin-sidebar-item';
      li.innerHTML = `
        <a href="#" title="${app.label}">
          <span class="sidebar-icon"><i class="${app.icon}"></i></span>
          <span class="label">${app.label}</span>
        </a>`;
      favList.appendChild(li);
    });
  };

  const toggleFavorite = () => {
    const favs = new Set(getFavs());
    favs.has(DEMO_APP.id) ? favs.delete(DEMO_APP.id) : favs.add(DEMO_APP.id);
    setFavs([...favs]); render();
  };

  // Click on any star button
  document.addEventListener('click', (e) => {
    const btn = e.target.closest('.favorite-toggle-button');
    if (!btn) return;
    e.preventDefault();
    toggleFavorite();
  });

  // Block demo form submit
  document.querySelectorAll('.toggleFavoriteForm').forEach(f =>
    f.addEventListener('submit', e => e.preventDefault())
  );

  render();
  addEventListener?.('astro:page-load', render);
})();
</script>
<script is:inline>
  (function(){
    const btn = document.querySelector('.mini-theme-toggle');
    if(!btn) return;
    btn.addEventListener('click', () => {
      const html = document.documentElement;
      const next = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', next);
      try{ localStorage.setItem('theme', next); }catch{}
    });
  })();
</script>

 <!-- Overlay + support panel (static) -->
<input hidden type="checkbox" id="toggleSidebarOptions" />
<label for="toggleSidebarOptions" class="support-overlay" id="supportOverlayLeft" aria-hidden="true"></label>

<section class="sidebar-extra-wrapper" id="supportPanel" hidden>
  <div class="container__support" id="supportFormContent">
    <form class="sendEmailForm" id="sendForm">
      <div class="container__heading">
        <div>
          <h3 class="mb-2 text-always-light">Contact support</h3>
          <span class="text-always-light">Tell us what you need help with.</span>
        </div>
      </div>

      <div class="gap-4 w-full form form__label-above">
        <div class="form__item text-always-light">
          <label for="email">Email<span class="required-asterisk">*</span></label>
          <input id="email" required type="email" class="field field__input" placeholder="you@company.com" />
        </div>

        <div class="form__item text-always-light">
          <label for="phone">Phone <span class="optional">(optional)</span></label>
          <input id="phone" type="tel" class="field field__input" placeholder="+372 5555 5555" />
        </div>
      </div>

      <div class="form__label-above text-always-light">
        <div class="form__item text-always-light">
          <label for="topic">Topic<span class="required-asterisk">*</span></label>
          <div class="select-wrapper">
            <select id="topic" class="select__field">
              <option value="POS">POS</option>
              <option value="Backoffice">Backoffice</option>
              <option value="GOERP">GOERP</option>
              <option value="Other">Other</option>
            </select>
            <span class="select-icon"><i class="ri-arrow-down-s-line"></i></span>
          </div>
        </div>
      </div>

      <div class="form__label-above text-always-light">
        <div class="form__item text-always-light">
          <label for="description">Description<span class="required-asterisk">*</span> <span class="optional">(min 10 chars)</span></label>
          <textarea id="description" required class="textarea" rows="5" placeholder="Describe the issue…"></textarea>
        </div>
      </div>

      <div id="attachment-files-list" class="attachment-files-list"></div>

      <div class="mt-4 flex items-center justify-between">
        <div class="flex gap-2">
          <button type="submit" class="btn btn__primary">Submit</button>
          <button type="reset" class="btn btn__neutral">Reset</button>
        </div>

        <label class="btn btn__neutral ml-auto">
          <i class="ri-attachment-2 font-sm"></i>
          <input hidden type="file" multiple accept="image/*,.pdf,.doc,.docx,.xlsx,.xls,.csv,.zip,.rar,.7zip,.asice" class="fileInput" />
        </label>
      </div>
    </form>
  </div>

  <label for="toggleSidebarOptions" class="support-panel__close text-always-light">
    <i class="ri-close-line"></i>
  </label>
</section>

<!-- MASTER TOGGLE (mobile) -->
<input type="checkbox" id="menuMasterToggle" hidden />
<div class="master-menu_mobile-header">
  <label for="menuMasterToggle" class="master-hamburger-button">
    <i class="ri-menu-line"></i>
    <i class="ri-close-line"></i>
  </label>
</div>

<div class="mobile-menu-overlay">
  <div class="thin-sidebar-group">
    <!-- Left: Company mini sidebar -->
    <aside class="extra-thin-sidebar company-sidebar">
      <div class="thin-sidebar-icons">
        <div class="account-switch-wrapper" id="accountSwitchWrapper2">
          <ul id="locationList2" class="flex-col">
            <!-- Active account (hardcoded) -->
            <li class="company-sidebar__item company-sidebar__item--has-submenu" data-number="14224">
              <div class="thin-sidebar-item company-sidebar__trigger">
                <a href="#" class="account-switch-btn item--active">
                  <span class="sidebar-icon-wrapper">
                    <span class="company-name sidebar-icon">MK</span>
                  </span>
                  <span class="label">Maria</span>
                  <span class="label" id="selectedLocation2" data-session="14224">#14224</span>
                </a>
              </div>
            </li>

            <!-- Users button -->
            <li class="thin-sidebar-item flex-col align-center">
              <a href="#" class="btn btn__secondary">
                <i class="ri-user-line"></i>
              </a>
              <span class="label">Users</span>
            </li>
          </ul>

          <div class="sidebar-divider mb-1"></div>

          <!-- Other accounts list (example) -->
          <div class="scroll-account-wrapper mt-1">
            <ul class="scrollable-account-list">
              <li class="company-sidebar__item company-sidebar__item--has-submenu searchable-account location-item flex-col" data-name="CAP" data-number="13188">
                <div class="thin-sidebar-item company-sidebar__trigger flex-col align-center">
                  <span class="sidebar-icon company-badge">CA</span>
                  <span class="label mt-1">CAP</span>
                  <span class="label">#131886</span>
                </div>
              </li>
               <li class="company-sidebar__item company-sidebar__item--has-submenu searchable-account location-item flex-col" data-name="Apple" data-number="44567">
                <div class="thin-sidebar-item company-sidebar__trigger flex-col align-center">
                  <span class="sidebar-icon company-badge">AP</span>
                  <span class="label mt-1">Apple</span>
                  <span class="label">#445676</span>
                </div>
              </li>
            </ul>
          </div>

          <!-- Sticky actions -->
          <div class="sticky-actions mb-auto">
            <div class="thin-sidebar-item flex-col align-center company-sidebar__item--has-submenu">
              <div class="thin-sidebar-item flex-col align-center company-sidebar__item--has-submenu">
                    <div class="thin-sidebar-item company-sidebar__trigger flex-col align-center">
                      <span class="btn btn__secondary">
                         <i class="ri-community-line"></i>
                      </span>
                      <span class="label">Find Company</span>
                    </div>
                </div>
              <div class="company-sidebar__submenu" id="accountSearchWrapperContainer">
                <div class="company-sidebar__submenu-userinfo flex-col" id="accountSearchWrapper">
                  <div class="sidebar-search-wrapper">
                    <i class="ri-search-line"></i>
                    <input id="accountSearchInput" class="sidebar-search-input" type="text" placeholder="Search company…" />
                  </div>
                  <ul id="accountSearchResults" class="search-results-list justify-between"></ul>
                </div>
              </div>
             
            </div>
            

            <div class="thin-sidebar-item flex-col align-center mt-1">
              <a href="#" class="btn btn__secondary"><i class="ri-add-line"></i></a>
              <span class="label">Add company</span>
            </div>
          </div>
        </div>
      </div>

      <div class="sidebar-divider mb-1"></div>

      <!-- Bottom: settings/help/logout/theme -->
      <ul class="thin-sidebar--settings-container">
        <li class="company-sidebar__item company-sidebar__item--has-submenu">
          <div class="thin-sidebar-item company-sidebar__trigger flex-col align-center">
            <span class="sidebar-icon"><i class="ri-settings-3-line"></i></span>
            <span class="label">Settings</span>
          </div>
          <div class="company-sidebar__submenu--below">
            <a href="#" class="company-sidebar__link flex align-center"><i class="ri-key-2-line"></i><span>Change password</span></a>
            <a href="#" class="company-sidebar__link flex align-center"><i class="ri-lock-2-line"></i><span>Two-step auth</span></a>
          </div>
        </li>

        <li class="company-sidebar__item company-sidebar__item--has-submenu">
          <div class="thin-sidebar-item company-sidebar__trigger flex-col align-center">
            <span class="sidebar-icon"><i class="ri-question-line"></i></span>
            <span class="label">Help</span>
          </div>
          <div class="company-sidebar__submenu--below">
            <a href="#" class="company-sidebar__link flex align-center" target="_blank" rel="noreferrer">
              <i class="ri-book-open-line"></i><span>Wiki</span>
            </a>
            <label for="toggleSidebarOptions" class="company-sidebar__link flex align-center" aria-controls="supportPanel" aria-expanded="false">
              <i class="ri-ticket-line"></i><span>Create ticket</span>
            </label>
            <a href="#" class="company-sidebar__link flex align-center"><i class="ri-headphone-line"></i><span>Support agent</span></a>
          </div>
        </li>

        <li>
          <button class="thin-sidebar-item flex-col align-center" type="button">
            <span class="sidebar-icon"><i class="ri-logout-box-line"></i></span>
            <span class="label">Logout</span>
          </button>
        </li>

        <li>
              <!-- one compact button, shows the target theme -->
              <button
                type="button"
                class="mini-theme-toggle"
                data-theme-toggle
                aria-label="Switch to dark theme"
              >
                <!-- Sun (shown in dark mode so user can switch to light) -->
                <svg class="icon-sun" viewBox="0 0 24 24" aria-hidden="true">
                  <g fill="currentColor" stroke="currentColor" stroke-width="1.75" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="4.25"/>
                    <path d="M12 2.5v2.5M12 19v2.5M4.22 4.22l1.77 1.77M17.99 18l1.78 1.78M2.5 12H5M19 12h2.5M4.22 19.78L6 18M18 6l1.78-1.78"/>
                  </g>
                </svg>

                <!-- Moon (shown in light mode so user can switch to dark) -->
                <svg class="icon-moon" viewBox="0 0 24 24" aria-hidden="true">
                  <path
                    d="M21 13.25A8.75 8.75 0 0 1 10.75 3 9.75 9.75 0 1 0 21 13.25z"
                    fill="currentColor" stroke="currentColor" stroke-width="1.75" stroke-linejoin="round"
                  />
                </svg>
              </button>
        </li>
          
      </ul>
    </aside>

    <!-- Right: App switcher thin sidebar -->
    <aside class="extra-thin-sidebar extra-thin-sidebar--second">
      <div class="extra-thin-sidebar_header">
      <form method="post" class="toggleFavoriteForm">
        <button type="submit" aria-label="Toggle favorite" class="favorite-toggle-button">
          <i class="ri-star-line"></i>
        </button>
      </form>
        <button class="btn btn__secondary action-button--back"><i class="ri-arrow-left-line"></i></button>
        <ul class="thin-sidebar-icons">
          <li class="thin-sidebar-item">
            <a href="#"><span class="sidebar-icon"><i class="ri-archive-2-line"></i></span><span class="label">Inventory</span></a>
          </li>
          <li class="thin-sidebar-item">
            <a href="#"><span class="sidebar-icon"><i class="ri-group-line"></i></span><span class="label">Customers</span></a>
          </li>
          <li class="thin-sidebar-item">
            <a href="#" title="Emails">
              <span class="sidebar-icon"><i class="ri-mail-line"></i></span>
              <span class="label">Emails</span>
            </a>
          </li>
          <li class="thin-sidebar-item">
            <a href="#" title="Locations">
              <span class="sidebar-icon"><i class="ri-map-pin-2-line"></i></span>
              <span class="label">Locations</span>
             </a>
          </li>
          <li class="thin-sidebar-item">
            <a href="#" title="Quote">
              <span class="sidebar-icon"><i class="ri-file-list-3-line"></i></span>
              <span class="label">Quote</span>
             </a>
          </li>
          <li class="thin-sidebar-item">
            <a href="#" title="App Store">
              <span class="sidebar-icon"><i class="ri-add-circle-line"></i></span>
              <span class="label">App Store</span>
            </a>
          </li>
        </ul>
        <!-- ⭐ Favorites appear here -->
        <ul id="favApps" class="thin-sidebar-icons fav-apps"></ul>
      </div>


      <div class="mt-auto p-2">
   
            <button data-toggle-menu class="btn hide-on-mobile mt-2">
          
                <svg class="icon-rotate-up" width="14" height="16" viewBox="0 0 14 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                   <path
                  fill="currentColor"
                  fill-rule="evenodd"
                  clip-rule="evenodd" d="M2.25635 0.916687C1.83538 0.916687 1.47868 1.06285 1.18701 1.35451C0.89554 1.64611 0.750026 2.00223 0.75 2.42303V13.577C0.750026 13.9978 0.89554 14.3539 1.18701 14.6455C1.47868 14.9372 1.83538 15.0834 2.25635 15.0834H12.1595C12.5805 15.0834 12.9372 14.9372 13.2288 14.6455C13.5204 14.3539 13.6666 13.9979 13.6667 13.577V2.42303C13.6666 2.00218 13.5204 1.64613 13.2288 1.35451C12.9372 1.06285 12.5805 0.916687 12.1595 0.916687H2.25635ZM7.77067 13.8334H2.25635C2.19218 13.8334 2.13309 13.8063 2.07975 13.7528C2.02648 13.6996 2.00003 13.641 2 13.577V2.42303C2.00003 2.35901 2.02648 2.30049 2.07975 2.24725C2.13309 2.19378 2.19218 2.16669 2.25635 2.16669H7.77067V13.8334Z"/>
                </svg>
           
         
         
            </button>
          </form>
        </div>
    </aside>
  </div>

  <!-- Main nav (sidebar/topnav switches via body class) -->
  <nav class="menu menu--sidebar" aria-label="Main Navigation">
    <div class="menu__header flex">
      <a class="badge app__badge" href="#"><i class="ri-apps-2-fill"></i></a>
      <h2 class="menu__title">Minimal demo of navigation menu</h2>
    </div>

    <div class="menu__center">
      <!-- Group 1 -->
      <div class="sidebar-group" data-caret="1">
        <label class="sidebar__item">
          <i class="ri-dashboard-2-line"></i>
          <span class="sidebar__label">Overview</span>
        </label>
         <div class="sub-menu_down">
          <div class="sidebar__third-level-menu">
            <div class="submenu-section">
              <ul>
                <li><a class="font-sm" href="#"><span>Dashboard</span></a></li>
                <li><a class="font-sm" href="#"><span>Time logs</span></a></li>
              </ul>
            </div>
           
          </div>
        </div>
       
      </div>

      <!-- Group 2 with 3rd-level sections -->
      <div class="sidebar-group" data-caret="1">
        <label class="sidebar__item">
          <i class="ri-settings-3-line"></i>
          <span class="sidebar__label">Configuration</span>
        </label>
        <div class="sub-menu_down">
          <div class="sidebar__third-level-menu">
            <div class="submenu-section">
              <ul>
                <li><a class="font-sm" href="#"><span>Localization</span></a></li>
                <li><a class="font-sm" href="#"><span>Users</span></a></li>
              </ul>
            </div>
           
          </div>
        </div>
      </div>

      <!-- Group 3 with 3rd-level sections -->
      <div class="sidebar-group" data-caret="1">
        <label class="sidebar__item">
          <i class="ri-shopping-cart-line"></i>
          <span class="sidebar__label">Orders</span>
        </label>
        <div class="sub-menu_down">
          <div class="sidebar__third-level-menu">
            <div class="submenu-section">
              <ul>
                <li><a class="font-sm" href="#"><span>Sales</span></a></li>
                <li><a class="font-sm" href="#"><span>Invoices</span></a></li>
              </ul>
            </div>
           
          </div>
        </div>
      </div>

      
    </div>

    <!-- Topnav-only footer trigger (kept minimal) -->
    <div class="flex only-topnav ml-auto gap-3 align-center">
      <label class="landing-link" for="toggleTopnavFooter" title="App updated">
        <i class="ri-checkbox-circle-line text-green mr-1" aria-hidden="true"></i>
        <span class="text-green">v.</span><span class="text-green">1.0.0</span>
      </label>
      <label class="menu__item name-initial"><span id="userInitials">MK</span></label>
      <div class="flex-col">
        <span class="company-name" title="Demo Company">Demo Company</span>
        <span class="sidebar-label" id="selectedLocation">142242425</span>
      </div>
    </div>
    <input type="checkbox" id="toggleTopnavFooter" hidden />
    <div class="menu__footer-wrapper">
      <div class="menu__version">
        <div class="flex align-center justify-between">
          <span class="badge badge__uptodate"><i class="ri-checkbox-circle-line"></i>App is up to date!</span>
          <div class="flex"><span class="label">v.</span><span class="ml-1">1.0.0</span></div>
        </div>
      </div>
    </div>
  </nav>
</div>

  <!-- your case study content -->
<!-- your case study content -->
<article class="container-narrow doc-grid">

  <div class="doc-main">
    <h1>Unified Navigation System</h1>
    <p class="meta">Role: Frontend & UX • Timeline: 2024–2025 • Tech: HTML, CSS, JS, GO</p>

    <h2>Context & Problem</h2>
    <p>Multiple apps used duplicated markup for sidebar/topnav with inconsistent behavior and a11y gaps.</p>

    <h2>Approach</h2>
    <ul>
      <li>Single base markup toggled between sidebar and topnav via outer class</li>
      <li>Mobile overlay with ESC / outside click / focus trap</li>
      <li>Checkbox/radio for submenus; minimal JS</li>
    </ul>

    <h2>Behavior & Accessibility</h2>
    <ul>
      <li><strong>Keyboard:</strong> Enter/Space toggles sections, ESC closes.</li>
      <li><strong>Outside click:</strong> Closes submenus, support panel, overlays.</li>
      <li><strong>Mobile overlay:</strong> Hamburger toggles, scroll lock, aria-expanded.</li>
    </ul>

    <h2>Outcome</h2>
    <ul>
      <li>Removed duplicate HTML across all app views</li>
      <li>Improved consistency + accessibility</li>
      <li>Shared JSON + single asset enables rapid changes</li>
    </ul>

    <div class="demo-controls">
  <button class="btn" data-toggle-menu>Toggle: Sidebar / Topnav</button>
</div>

   
  </div>

  <aside class="doc-aside feature-card">
    <div class="num">01.</div>
      <h2>Menu Architecture & Structure</h2>

    <ol class="tight">
       <li>
      <strong>Company Sidebar (Level 1)</strong> —  
      A vertical thin sidebar always visible on desktop. It contains user identity, company switcher, language, theme toggle, and help/support entry points.
      Submenus open below and close automatically on outside click or <kbd>ESC</kbd>.
    </li>
    <li>
      <strong>Bookmarks / Favorites (Level 2)</strong> —  
      A thin sidebar that lists user’s favorite or pinned apps. State is stored via CaFa configuration <code>favorite-apps</code>,
      so the same favorites appear across sessions. Clicking a star toggles app visibility here instantly.
    </li>
    <li>
      <strong>App Navigation (Level 3)</strong> —  
      Each app imports a shared menu asset that builds its structure from JSON.  
      The menu can switch between <em>sidebar</em> and <em>topnav</em> layouts using the same markup,
      controlled by outer classes<br><code>.menu--sidebar</code> / <code>.menu--topnav</code>.
    </li>
    </ol>

    <!-- Optional note about demo limitations -->
    <p class="demo-note">
      This is a minimal interactive demo: focus trapping, roving tabindex,
      full screen reader labelling, and persisted favorites are omitted for brevity. Lot of functionality not implemented here as this was tied with client interface.
    </p>
  </aside>
</article>

</Base>


